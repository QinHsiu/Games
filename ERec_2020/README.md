# [电商用户购买行为预测 竞赛 - DataFountain](https://www.datafountain.cn/competitions/482)

## 1.赛题背景与任务

#####  赛题：互联网的出现和普及给用户带来了大量的信息，满足了用户在信息时代对信息的需求，但是网上信息量的大幅增长也带来了“信息过载”的问题。这使得用户在面对大量信息时无法从中获得对自己真正有用的信息，导致用户对信息的使用效率大大降低了。为了帮助用户更快速地过滤出有用的信息，需要依据真实的用户购买行为记录，利用机器学习相关技术建立稳健的电商用户购买行为预测模型，用于预测用户的下一个行为，以此为用户进行商品的推荐，准确捕获用户的购买兴趣，提高电商平台商品的购买率。

##### 赛题任务：依据电子商务平平台上真实的用户行为记录，利用机器学习相关技术，建立稳健的电商用户购买行为预测模型，预测用户下一个可能会购买的商品。

## 2.数据解析介绍

##### 数据使用的是某化妆公司的真实数据，已经做过脱敏处理，其数据统计如下所示：

| Data             | #users | #items | #category | #e_time | #e_type | #brand | #price | #user_session | #c_code |
| ---------------- | ------ | ------ | --------- | ------- | ------- | ------ | ------ | ------------- | ------- |
| Train Dataset    | 53975  | 32734  | 55        | 173711  | 4       | 223    | 1579   | 85312         | 11      |
| Test Dataset     | 558    | 2691   | 45        | 3620    | 4       | 126    | 513    | 937           | 7       |
| Missing Numbers  | 0      | 0      | 0         | 0       | 0       | 164944 | 0      | 38;2          | 410798  |
| Abnormal Numbers | 0      | 0      | 0         | 0       | 0       | #      | 2      | 0             | #       |
| Cold Start       | 558    | 50     | 0         | 0       | 0       | #      | 0      | 0             | #       |

##### 从上表可以获知以下几条信息，并对应做出相关处理操作：

- 其中brand和category_code缺失值较多直接进行删除处理；
- 训练集中有两个数据购买价格为负值（行为为购买，但是价格为负值），因为查找相同类别商品没有（无法填充），直接进行删除；
- 发现有50个商品只在测试集中出现，在对商品id进行embedding时需要考虑这一点，另外用于所有测试集中的用户id都没有在训练集中出现过，因此在建模过程中不对用户id进行单独考虑；
- user_session表示用户会话id，训练集中缺失38条，测试集中缺失2条，直接剔除会话id这一特征；

## 3.模型构建

##### 这里会对推荐系统工业界中常用的模型进行汇总和比较，具体每一个模型的实验细节如下所示：

- 逻辑回归模型(LR)，使用传统的LR模型对每一条数据进行预测，在这里因为是直接进行逻辑回归，没有考虑特征交叉的问题，所以需要手动添加一些特征，这里会对用户购买、浏览、删除、加购商品的价格分别做平均作为每一条数据的四个补充特征，另外因为预测目标为用户下一个时刻可能购买的商品。故还需要考虑用户事件中的一些行为，划分数据集有以下几种方式：

  - 只考虑用户购买过的商品用于训练和验证（这样最接近目标的数据分布，但是会导致数据过于稀疏）
  - 只考虑用户正向行为的数据用于训练和验证（只考虑用户购买和加入购物车的数据，数据还是很稀疏）
  - 不考虑用户的负向行为的数据用于训练和验证（不考虑用户从购物车中删除的记录数据，还是会导致数据很稀疏）
  - 考虑所有用户的数据用于训练和验证

  另外因为这是一个预测用户下一个时刻可能交互的商品，可以将其看作是一个多分类任务，因此这里使用softmax作为模型的最后一层的输出，其输出结果的大小应该为[1xN]，其中N表示商品的数目

- 因子分解机(FM)，

- GDBT+LR，

- 



## 4.实验结果

##### 这里使用F1-score、Recall@10，NDCG@10，MRR@10作为实验评价指标，实验结果如下表所示：



## 5.结果复现

## 7.总结





